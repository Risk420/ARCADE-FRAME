<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Arcade Gif Studio | HD</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <style>
        :root { --neon: #00f3ff; --purple: #bc13fe; --red: #ff0055; --bg: #000000; }
        ::-webkit-scrollbar { display: none; }
        
        body { 
            background: var(--bg); color: white; font-family: sans-serif; 
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; margin: 0; padding-top: 30px; width: 100%;
            overflow-x: hidden;
        }

        /* Layout: Matching the thick, blurred LED ring from your image */
        .stage { 
            position: relative; width: 310px; height: 310px; 
            margin-bottom: 30px; touch-action: none; 
        }
        .led-ring { 
            position: absolute; inset: -12px; border-radius: 50%; 
            background: conic-gradient(from 180deg, var(--neon), var(--purple), var(--neon)); 
            animation: rotate 3s linear infinite; filter: blur(25px); z-index: 1;
        }
        
        .viewport { 
            position: relative; z-index: 5; width: 100%; height: 100%; border-radius: 50%; 
            overflow: hidden; background-color: #000;
            background-image: linear-gradient(45deg, #111 25%, transparent 25%), 
                              linear-gradient(-45deg, #111 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #111 75%), 
                              linear-gradient(-45deg, transparent 75%, #111 75%);
            background-size: 20px 20px; box-shadow: inset 0 0 30px #000;
        }

        #v { position: absolute; top: 0; left: 0; pointer-events: none; will-change: transform; }
        #o { width: 100%; height: 100%; object-fit: cover; display: none; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Control Panel: Matching the dark rounded UI from the screenshot */
        .ui { 
            background: #151517; padding: 25px; border-radius: 35px; 
            width: 330px; border: 1px solid rgba(255,255,255,0.05); 
            display: flex; flex-direction: column; align-items: center; z-index: 10;
        }
        
        .btn-upload { 
            background: #2a2a2e; color: #fff; border: none; padding: 16px; 
            border-radius: 50px; font-weight: 800; cursor: pointer; width: 100%; 
            margin-bottom: 25px; font-size: 13px; text-transform: uppercase; letter-spacing: 1px;
        }

        .label-row { display: flex; justify-content: space-between; font-size: 11px; color: #777; margin-bottom: 8px; width: 100%; font-weight: bold; }
        
        input[type="range"] { 
            width: 100%; accent-color: #444; margin-bottom: 25px; height: 6px; border-radius: 5px; cursor: pointer;
        }

        .btn-go { 
            background: #1a1a1c; color: #d4af37; border: 1px solid #333; padding: 16px; 
            width: 100%; border-radius: 18px; cursor: pointer; font-weight: 900; font-size: 14px;
        }

        #msg { margin-top: 15px; font-size: 12px; color: var(--neon); font-weight: 600; height: 18px; visibility: hidden; }
        
        /* Specialized neon buttons for result */
        .neon-wrap { position: relative; display: none; margin-top: 15px; padding: 3px; border-radius: 50px; overflow: hidden; width: 100%; }
        .neon-wrap.blue::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(transparent, var(--neon), var(--purple), transparent); animation: rotate 2s linear infinite; }
        .btn-inner { position: relative; display: block; text-decoration: none; text-align: center; color: white; background: #000; padding: 14px; border-radius: 48px; font-weight: 900; font-size: 13px; z-index: 1; cursor: pointer; border: none; }
    </style>
</head>
<body>
    <div class="stage">
        <div class="led-ring"></div>
        <div class="viewport" id="vp">
            <video id="v" muted playsinline loop></video>
            <img id="o">
        </div>
    </div>

    <div class="ui">
        <button class="btn-upload" onclick="document.getElementById('f').click()">UPLOAD YOUR VIDEO</button>
        <input type="file" id="f" accept="video/*" style="display:none">

        <div class="label-row"><span>ZOOM / SCALE</span><span id="zv">100%</span></div>
        <input type="range" id="zoom" min="100" max="300" value="100">

        <div class="label-row"><span>PLAYBACK SPEED</span><span id="sv">1.0x</span></div>
        <input type="range" id="speed" min="0.5" max="3.0" step="0.1" value="1.0">

        <button id="go" class="btn-go">⚡ CREATE HD GIF</button>
        <div id="msg">Processing...</div>
        
        <div id="dlBox" class="neon-wrap blue"><a id="dl" class="btn-inner">⬇️ DOWNLOAD GIF</a></div>
    </div>

    <script>
        const workerBlob = new Blob([`importScripts('https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js');`], { type: 'application/javascript' });
        const workerUrl = URL.createObjectURL(workerBlob);
        const f = document.getElementById('f'), v = document.getElementById('v'), o = document.getElementById('o'), vp = document.getElementById('vp');
        const speed = document.getElementById('speed'), sv = document.getElementById('sv'), zoom = document.getElementById('zoom'), zv = document.getElementById('zv'), go = document.getElementById('go'), msg = document.getElementById('msg'), dlBox = document.getElementById('dlBox'), dl = document.getElementById('dl');
        
        let isDragging = false, startX, startY, startLeft, startTop, naturalW = 0, naturalH = 0;

        f.onchange = (e) => {
            const file = e.target.files[0]; if (!file) return;
            v.src = URL.createObjectURL(file); v.onloadedmetadata = () => {
                naturalW = v.videoWidth; naturalH = v.videoHeight;
                const aspect = naturalW / naturalH; v.style.left = '0px'; v.style.top = '0px';
                if (aspect > 1) { v.style.height = '310px'; v.style.width = (310 * aspect) + 'px'; } 
                else { v.style.width = '310px'; v.style.height = (310 / aspect) + 'px'; }
                v.play();
            };
        };

        zoom.oninput = () => {
            if(!v.src) return; zv.innerText = zoom.value + '%'; const z = parseInt(zoom.value) / 100;
            const aspect = naturalW / naturalH; let baseW = aspect > 1 ? 310 * aspect : 310, baseH = aspect > 1 ? 310 : 310 / aspect;
            v.style.width = (baseW * z) + 'px'; v.style.height = (baseH * z) + 'px';
        };

        const startDrag = (x, y) => { if(!v.src) return; isDragging = true; startX = x; startY = y; startLeft = parseFloat(v.style.left || 0); startTop = parseFloat(v.style.top || 0); };
        const doDrag = (x, y) => { if (!isDragging) return; const dx = x - startX, dy = y - startY; v.style.left = (startLeft + dx) + 'px'; v.style.top = (startTop + dy) + 'px'; };
        vp.onmousedown = e => startDrag(e.pageX, e.pageY); window.onmousemove = e => doDrag(e.pageX, e.pageY); window.onmouseup = () => isDragging = false;
        vp.ontouchstart = e => startDrag(e.touches[0].pageX, e.touches[0].pageY); window.ontouchmove = e => doDrag(e.touches[0].pageX, e.touches[0].pageY); window.ontouchend = () => isDragging = false;
        speed.oninput = () => { sv.innerText = speed.value + 'x'; v.playbackRate = parseFloat(speed.value); };

        go.onclick = () => {
            if(!v.src) return;
            go.disabled = true; msg.style.visibility = "visible";
            const gif = new GIF({ workers: 2, quality: 10, width: 480, height: 480, workerScript: workerUrl });
            const canvas = document.createElement('canvas'); canvas.width = 480; canvas.height = 480; const ctx = canvas.getContext('2d');
            const fps = 24, duration = v.duration, playbackSpeed = parseFloat(speed.value), capVid = document.createElement('video');
            capVid.src = v.src; capVid.onloadeddata = () => {
                const cW = parseFloat(v.style.width), cH = parseFloat(v.style.height), cL = Math.abs(parseFloat(v.style.left || 0)), cT = Math.abs(parseFloat(v.style.top || 0)), rW = naturalW / cW, rH = naturalH / cH, sx = cL * rW, sy = cT * rH, sw = 310 * rW, sh = 310 * rH;
                let cTime = 0; const captureFrame = () => {
                    if (cTime >= duration) { gif.render(); return; }
                    capVid.currentTime = cTime;
                };
                capVid.onseeked = () => { ctx.drawImage(capVid, sx, sy, sw, sh, 0, 0, 480, 480); gif.addFrame(ctx, {copy: true, delay: (1000 / fps) / playbackSpeed}); cTime += (1 / fps); captureFrame(); };
                captureFrame();
            };
            gif.on('finished', (blob) => {
                const url = URL.createObjectURL(blob), rNum = Math.floor(Math.random() * 90000) + 10000;
                v.style.display = 'none'; o.src = url; o.style.display = 'block';
                dl.href = url; dl.download = `neon_focus_${rNum}.gif`;
                dlBox.style.display = 'inline-block'; msg.style.visibility = "hidden"; go.disabled = false;
            });
        };
    </script>
</body>
</html>
